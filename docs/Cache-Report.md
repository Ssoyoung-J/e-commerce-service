# 📄 이커머스 인기 상품 조회 기능 성능 개선 보고서 (Redis Cache 활용)

## 1. 개요

이 보고서는 이커머스 서비스의 **인기 상품(Top N)** 조회 기능의 응답 속도 향상과 시스템 부하 감소를 위해 **Redis 캐시**를 도입한 전략과 그 효과를 설명합니다.  
인기 상품 데이터는 **조회 빈도는 높지만 갱신 빈도는 낮은 특성**이 있어, 캐시 적용이 적절한 대상입니다.

---

## 2. 기존 구조 및 문제점

### 🔸 기존 방식

- 인기 상품 조회 시마다 DB에서 실시간으로 집계 쿼리 수행 (주문 수, 조회 수 등)
- JOIN 및 GROUP BY가 포함된 복잡한 쿼리가 반복적으로 수행됨

### 🔸 문제점

- 반복적인 DB 접근으로 인해 **DB 부하 증가**
- 응답 속도 지연 → 사용자 경험 저하
- 인기 상품은 자주 조회되므로, **데이터 낭비 및 시스템 리소스 과소비**

---

## 3. 캐싱 대상 및 효과 분석

### ✅ 캐싱에 적합한 데이터: 인기 상품

- **자주 조회되지만 변경은 드물다**
- 실시간성이 엄격히 요구되지 않는 데이터
- 반복 조회 시 캐시 적중률을 높여 **DB 부하 감소** 가능

### ✅ 캐시 도입 전 문제점 요약

- 평균 응답 시간 증가
- 트래픽 집중 시 DB 병목 현상
- 서비스 확장성 저하

---

## 4. Redis 캐시 전략 적용

### 🔹 Read-Through 캐시 전략

#### ✔ Cache Hit 흐름

1. 사용자가 인기 상품 조회 요청
2. Redis에서 해당 데이터를 조회
3. 캐시 존재 시 Redis에서 즉시 응답
4. 사용자에게 빠르게 결과 반환

#### ✔ Cache Miss 흐름

1. Redis에 데이터가 없을 경우 DB에서 조회
2. 조회한 데이터를 Redis에 저장
3. 다음 요청부터는 캐시 데이터 사용

> ⚠️캐시 스탬피드(Cache Stampede) 가능성 있음  
> → 동일 시점에 여러 요청이 Cache Miss 발생 시 DB에 부하 집중  
> → 일관성 문제 발생 가능성도 존재 (예: 캐시-DB 간 갱신 시점 차이)

---

### 🔹 Write-Through 캐시 전략

- 스케줄러 또는 배치 작업이 주기적으로 인기 상품 데이터를 DB에서 조회
- 조회한 데이터를 Redis에 저장하여 **항상 최신 상태 유지**
- 데이터 정합성을 확보하고 캐시 미스를 줄이는 효과

---

## 5. 정리 및 향후 과제

- 캐시 도입을 통해 **DB 부하를 줄이고 응답 속도를 개선**할 수 있었음
- 단, 현재는 **분산 락 미적용 상태**로, 고트래픽 시점에 Cache Stampede 방지 전략이 미흡할 수 있음
- **향후 STEP11 분산 락 도입**을 통해 데이터 정합성 보장 필요함

---

## ✍️ 작성자 참고 메모

- 분산 락 적용 전
- 캐시 미스 상황에서 정합성 문제 발생 여부 확인 필요